# Ansible's apt module requires aptitude and python-apt. The two tasks below fix that.
- name: Do we have aptitude?
  stat: path=/usr/bin/aptitude
  register: aptitude_stat

- name: Ensure that requirements for the apt action are present
  shell: apt-get update && apt-get install -y python-apt aptitude
  when: not aptitude_stat.stat.exists

- name: apt-get update/upgrade
  apt: update_cache=yes upgrade=yes cache_valid_time=3600

- name: Ensure required packages are present
  apt: "name={{ item }} state=present"
  with_items: "{{ required_packages }}"

- name: Ensure required packages for development are present
  apt: "name={{ item }} state=present"
  with_items: "{{ required_packages_dev }}"

- name: Add repository for python 3.6 installation
  shell: add-apt-repository ppa:jonathonf/python-3.6 -y

- name: apt-get update
  apt: update_cache=yes

- name: Ensure python 3.6 is installed
  apt: "name={{ item }} state=present"
  with_items:
    - python3.6
    - python3.6-dev
